import{f as M}from"./index-3be0d155.js";import{a as f}from"./element-plus-7da03efa.js";import{k as G,e as V,$ as H,i as O,ah as s,ar as J,o as w,c as K,W as t,Q as o,a as x,U as d,V as Q,R as W,P as j}from"./@vue-d9027515.js";import"./index-1fb9eb7d.js";import"./pinia-be7e992d.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-a2fac16f.js";import"./vue-i18n-e0b9a81d.js";import"./@intlify-9e8a497c.js";import"./source-map-7d7e1c08.js";import"./vue-b46b26c7.js";import"./js-cookie-cf83ad76.js";import"./@element-plus-96a31696.js";import"./nprogress-8d2808ea.js";import"./axios-707ed124.js";import"./qs-bbfcbdf3.js";import"./side-channel-eafc5c70.js";import"./get-intrinsic-b9397c9a.js";import"./has-symbols-e8f3ca0e.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-9ceb8f5b.js";import"./object-inspect-7b08a46e.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-0ee01be3.js";import"./lodash-es-36eb724a.js";import"./@vueuse-2d9216d7.js";import"./@ctrl-f8748455.js";import"./dayjs-6aac7dfa.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-463e90e0.js";import"./requestFSGet-d236e20b.js";const q={class:"system-user-dialog-container"},X={class:"dialog-footer"},Y={class:"system-user-search mb15"},Z=G({name:"fopsAppDialog"}),Le=G({...Z,emits:["refresh"],setup(ee,{expose:y,emit:b}){const c=M(),A=V(),g=V(),e=H({ruleForm:{AppName:"",AppId:"",DockerVer:"",ShellScript:"",ClusterVer:"",AppGit:0,FrameworkGits:[],Dockerfile:"",DockerfilePath:""},gitList:[],SelectItem:[],gitDialogIsShow:!1,dialog:{isShowDialog:!1,type:"",title:"",submitTxt:""},tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10}},gitType:1}),I=(a,l)=>{e.dialog.type=a,a==="edit"?(e.ruleForm=l,e.dialog.title="修改应用",e.dialog.submitTxt="修 改",c.appsDetail({AppName:l.AppName}).then(function(r){r.Status&&(l=r.Data,e.ruleForm.AppName=l.AppName,e.ruleForm.AppId=l.AppId,e.ruleForm.DockerVer=l.DockerVer,e.ruleForm.ShellScript=l.ShellScript,e.ruleForm.ClusterVer=l.ClusterVer,e.ruleForm.AppGit=l.AppGit,e.ruleForm.FrameworkGits=l.FrameworkGits,e.ruleForm.Dockerfile=l.Dockerfile,e.ruleForm.DockerfilePath=l.DockerfilePath,e.SelectItem=l.FrameworkGits,_(l.FrameworkGits))})):(e.dialog.title="新增应用",e.dialog.submitTxt="新 增",e.ruleForm.AppName="",e.ruleForm.AppId="",e.ruleForm.DockerVer="",e.ruleForm.ShellScript="",e.ruleForm.ClusterVer="",e.ruleForm.AppGit=0,e.ruleForm.FrameworkGits=[],e.ruleForm.Dockerfile="",e.ruleForm.DockerfilePath=""),e.dialog.isShowDialog=!0},_=a=>{e.gitList=[];for(let l=0;l<a.length;l++)console.log(a[l]),c.gitInfo({gitId:a[l]}).then(function(r){r.Status?e.gitList.push(r.Data):e.gitList=[]})},h=a=>{e.ruleForm.FrameworkGits=e.ruleForm.FrameworkGits.filter(l=>l!==parseInt(a.Id)),_(e.ruleForm.FrameworkGits)},F=()=>{e.dialog.isShowDialog=!1},v=()=>{F()},C=()=>{var a={AppName:e.ruleForm.AppName,AppId:e.ruleForm.AppId,ShellScript:e.ruleForm.ShellScript,AppGit:parseInt(e.ruleForm.AppGit),FrameworkGits:e.ruleForm.FrameworkGits};if(e.dialog.type==="add"){var l=JSON.stringify(a);c.appsAdd(l).then(function(r){r.Status?(f.success("添加成功"),F(),b("refresh")):f.error(r.StatusMessage)})}else e.dialog.type=="edit"&&c.appsEdit(a).then(function(r){r.Status?(f.success("修改成功"),F(),b("refresh")):f.error(r.StatusMessage)})},N=()=>{c.gitList({}).then(function(a){a.Status?(e.tableData.data=a.Data,e.tableData.total=a.Data.length):e.tableData.data=[]})},T=a=>a.Id,U=a=>{if(console.log(a),a.length!=0){e.SelectItem=[];for(let r=0;r<a.length;r++){var l=a[r];e.SelectItem.push(l.Id)}console.log(e.SelectItem)}},D=a=>{N(),e.gitType=a,e.gitDialogIsShow=!0,a==1&&e.tableData.data.forEach(function(l,r){var p=e.ruleForm.FrameworkGits.filter(m=>m==l.Id);p.length>0?g.value.setCurrentRow(l):g.value.setCurrentRow(l,!1)})},z=()=>{e.gitType==1?(e.ruleForm.FrameworkGits=e.SelectItem,_(e.ruleForm.FrameworkGits)):e.ruleForm.AppGit=e.SelectItem[0],e.gitDialogIsShow=!1};return O(()=>{}),y({openDialog:I,delGit:h}),(a,l)=>{const r=s("el-input"),p=s("el-form-item"),m=s("el-col"),n=s("el-button"),P=s("el-tag"),u=s("el-table-column"),k=s("el-table"),L=s("el-row"),R=s("el-form"),S=s("el-dialog"),B=s("el-icon"),$=s("el-card"),E=J("loading");return w(),K("div",q,[t(S,{title:e.dialog.title,modelValue:e.dialog.isShowDialog,"onUpdate:modelValue":l[10]||(l[10]=i=>e.dialog.isShowDialog=i),width:"769px"},{footer:o(()=>[x("span",X,[t(n,{onClick:v,size:"default"},{default:o(()=>[d("取 消")]),_:1}),t(n,{type:"primary",onClick:C,size:"default"},{default:o(()=>[d(Q(e.dialog.submitTxt),1)]),_:1})])]),default:o(()=>[t(R,{ref_key:"gitDialogFormRef",ref:A,model:e.ruleForm,size:"default","label-width":"90px"},{default:o(()=>[t(L,{gutter:35},{default:o(()=>[t(m,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[t(p,{label:"应用名称"},{default:o(()=>[t(r,{modelValue:e.ruleForm.AppName,"onUpdate:modelValue":l[0]||(l[0]=i=>e.ruleForm.AppName=i),placeholder:"请输入应用名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[t(p,{label:"应用ID"},{default:o(()=>[t(r,{modelValue:e.ruleForm.AppId,"onUpdate:modelValue":l[1]||(l[1]=i=>e.ruleForm.AppId=i),placeholder:"请输入应用ID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[t(p,{label:"镜像版本"},{default:o(()=>[t(r,{modelValue:e.ruleForm.DockerVer,"onUpdate:modelValue":l[2]||(l[2]=i=>e.ruleForm.DockerVer=i),placeholder:"请输入镜像版本",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:12,lg:12,xl:12,class:"mb20"},{default:o(()=>[t(p,{label:"集群版本"},{default:o(()=>[t(r,{modelValue:e.ruleForm.ClusterVer,"onUpdate:modelValue":l[3]||(l[3]=i=>e.ruleForm.ClusterVer=i),placeholder:"请输入集群版本",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:o(()=>[t(p,{label:"Shell脚本"},{default:o(()=>[t(r,{modelValue:e.ruleForm.ShellScript,"onUpdate:modelValue":l[4]||(l[4]=i=>e.ruleForm.ShellScript=i),type:"textarea",placeholder:"请输入Shell脚本",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{xs:24,sm:18,md:18,lg:18,xl:18,class:"mb20"},{default:o(()=>[t(p,{label:"Git源代码",style:{float:"left"}},{default:o(()=>[t(r,{modelValue:e.ruleForm.AppGit,"onUpdate:modelValue":l[5]||(l[5]=i=>e.ruleForm.AppGit=i),placeholder:"请输入应用的源代码",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{type:"primary",onClick:l[6]||(l[6]=i=>D(2)),size:"default"},{default:o(()=>[d("添加Git")]),_:1})]),_:1}),t(m,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:o(()=>[t(P,null,{default:o(()=>[d("依赖的框架源代码")]),_:1}),t(n,{type:"primary",onClick:l[7]||(l[7]=i=>D(1)),size:"default"},{default:o(()=>[d("添加Git")]),_:1}),t(k,{data:e.gitList,style:{width:"100%"}},{default:o(()=>[t(u,{prop:"Id",label:"编号",width:"60"}),t(u,{prop:"Name",label:"Git名称","show-overflow-tooltip":""}),t(u,{prop:"Hub",label:"托管地址","show-overflow-tooltip":""}),t(u,{label:"操作",width:"100"},{default:o(i=>[t(n,{size:"small",text:"",type:"primary",onClick:le=>h(i.row)},{default:o(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(m,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:o(()=>[t(p,{label:"Dockerfile内容"},{default:o(()=>[t(r,{modelValue:e.ruleForm.Dockerfile,"onUpdate:modelValue":l[8]||(l[8]=i=>e.ruleForm.Dockerfile=i),type:"textarea",placeholder:"请输入Dockerfile内容",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{xs:24,sm:24,md:24,lg:24,xl:24,class:"mb20"},{default:o(()=>[t(p,{label:"Dockerfile路径"},{default:o(()=>[t(r,{modelValue:e.ruleForm.DockerfilePath,"onUpdate:modelValue":l[9]||(l[9]=i=>e.ruleForm.DockerfilePath=i),placeholder:"请输入Dockerfile路径",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),t(S,{title:"Git列表",modelValue:e.gitDialogIsShow,"onUpdate:modelValue":l[12]||(l[12]=i=>e.gitDialogIsShow=i),width:"700px;",height:"300px;"},{default:o(()=>[t($,{shadow:"hover",class:"layout-padding-auto"},{default:o(()=>[x("div",Y,[t(n,{size:"default",type:"success",class:"ml10",onClick:l[11]||(l[11]=i=>z())},{default:o(()=>[t(B),d(" 确认选择 ")]),_:1})]),W((w(),j(k,{ref_key:"multipleTable",ref:g,data:e.tableData.data,style:{width:"100%"},"row-key":T,onSelectionChange:U},{default:o(()=>[t(u,{type:"selection","reserve-selection":!0,width:"55"}),t(u,{prop:"Id",label:"编号",width:"60"}),t(u,{prop:"Name",label:"Git名称","show-overflow-tooltip":""}),t(u,{prop:"Hub",label:"托管地址","show-overflow-tooltip":""}),t(u,{prop:"Branch",label:"Git分支","show-overflow-tooltip":""})]),_:1},8,["data"])),[[E,e.tableData.loading]])]),_:1})]),_:1},8,["modelValue"])])}}});export{Le as default};
